{"ast":null,"code":"import React, { createElement } from 'react';\nimport { inheritsFrom } from './inherits-from';\nimport { Layer, View } from '@deck.gl/core';\n\nfunction wrapInView(node) {\n  if (!node) {\n    return node;\n  }\n\n  if (typeof node === 'function') {\n    return createElement(View, {}, node);\n  }\n\n  if (Array.isArray(node)) {\n    return node.map(wrapInView);\n  }\n\n  if (node.type === React.Fragment) {\n    return wrapInView(node.props.children);\n  }\n\n  if (inheritsFrom(node.type, View)) {\n    return node;\n  }\n\n  return node;\n}\n\nexport default function extractJSXLayers(_ref) {\n  let {\n    children,\n    layers,\n    views\n  } = _ref;\n  const reactChildren = [];\n  const jsxLayers = [];\n  const jsxViews = {};\n  React.Children.forEach(wrapInView(children), reactElement => {\n    if (reactElement) {\n      const ElementType = reactElement.type;\n\n      if (inheritsFrom(ElementType, Layer)) {\n        const layer = createLayer(ElementType, reactElement.props);\n        jsxLayers.push(layer);\n      } else {\n        reactChildren.push(reactElement);\n      }\n\n      if (ElementType !== View && inheritsFrom(ElementType, View) && reactElement.props.id) {\n        const view = new ElementType(reactElement.props);\n        jsxViews[view.id] = view;\n      }\n    }\n  });\n\n  if (Object.keys(jsxViews).length > 0) {\n    if (Array.isArray(views)) {\n      views.forEach(view => {\n        jsxViews[view.id] = view;\n      });\n    } else if (views) {\n      jsxViews[views.id] = views;\n    }\n\n    views = Object.values(jsxViews);\n  }\n\n  layers = jsxLayers.length > 0 ? [...jsxLayers, ...layers] : layers;\n  return {\n    layers,\n    children: reactChildren,\n    views\n  };\n}\n\nfunction createLayer(LayerType, reactProps) {\n  const props = {};\n  const defaultProps = LayerType.defaultProps || {};\n\n  for (const key in reactProps) {\n    if (defaultProps[key] !== reactProps[key]) {\n      props[key] = reactProps[key];\n    }\n  }\n\n  return new LayerType(props);\n}","map":null,"metadata":{},"sourceType":"module"}